
### Скачивание и запись образа на диск.

Для начала необходимо скачать  и записать образ диска на флешку с помощью например Rufus(Windows) или Ventoy(Linux).

### Установка дистрибутива

##### Подключение к интернет и настройка сети

Чтобы посмотреть текущее состояние подключения к сети необходимо выполнить следующую команду:
```bash
iwctl
```

Отобразить список доступных сетевых адаптеров:
```bash
device list
```

Запустить сканирование и поиск сетей используя выбранный сетевой адаптер:
```bash
station <adapter-name> scan
```

Получить список доступных для подключения сетей:
```bash
station <adapter-name> get-networks
```

Подключиться к выбранной сети:
```bash
station <adapter-name> connect <network-name>
```

Проверить подключение можно следующим образом:
```bash
ping vk.com
```

##### Основная установка

Для запуска скрипта установки дистрибутива необходимо выполнить следующую команду:
```bash
archinstall
```

###### Список зеркал (Mirrors)

Выбор списка зеркал, откуда будут скачаны основные компоненты.

**Mirrors > Mirror region**

###### Локализация (Locales)

Выбор локализации ОС, а также основной кодировки:

**Locales > Locale language**

Для быстрого поиска локализации можно набрать символ `/`

###### Конфигурация диска (Disk configuration)

**Disk configuration >Partitioning**

Для рекомендуемой автоматической разметки диска необходимо выбрать пункт **Use a best-effort default partion layout**. 

В качестве диска для установки системы необходимо выбрать флешку.

В качестве файловой системы можно выбрать `ext4`.

Отдельный раздел для домашней директории(`/home`) создавать не нужно, т.к. это флешка, поэтому можно выбрать пункт *no* в следующем меню.

###### Выбор загрузчика (Bootloader)

**Bootloader > Grub**

Можно выбрать загрузчик по умолчанию(`Systemd-boot`), если ваша система поддерживает UEFI или `Grub`. 
Первый более производительный и позволяет быстрее загружаться с флешки.

###### Раздел подкачки (Swap)

**Swap > no**

Отключаем подкачку, т.к. используем флеш-накопитель.

###### Имя устройства (Hostname)

**Hostname > yourhost**

Укажите название вашего устройства или оставьте значение по умолчанию.

###### Пароль для root (Root password)

**Root password > yoursecretpassword**

Придумайте и укажите надёжный пароль для привилегированного суперпользователя root.

###### Пользователь (User account)

**User account > Add a user**

Указываем новое имя и пароль для пользователя.
Выдать права суперпользователя новому пользователю.
После всего следует выбрать пункт **Confirm and exit**.

###### Профиль установки (Profile)

**Profile > Type > Desktop**

Необходимо выбрать графическое окружение, например, `Hyperland`.
После этого необходимо предоставить доступ к девайсам, выбрав пункт `polkit`.

**Graphics driver > Nvidia (proprietary)**

Для Nvidia также необходимо доустановить дополнительные пакеты, такие как: `nvidia-utils`, `nvidia-settings`, `opencl-nvidia` `xorg-server-devel`.

**Greeter > sddm**

###### Аудио (Audio)

**Audio > Pipewire**

В качестве аудио сервера можно использовать любой, например `Pipewire`.

###### Ядро системы (Kernels)

**Kernels > linux**

В качестве ядра можно выбрать любое из имеющихся.

###### Дополнительные пакеты (Additional packages)

**Additional packages**

В качестве дополнительных пакетов *необходимо* установить следующие: `git firefox hyprpaper hyprlock waybar fastfetch nvidia-utils egl-wayland lib32-nvidia-utils nvidia-settings opencl-nvidia xorg-server-devel`.

###### Конфигурация сети (Network configuration)

**Network configuration > Use NetworkManager**

###### Временная зона (Timezone)

**Timezone > Europe/Moscow**

###### Дополнительные репозитории (Optional repositories)

**Optional repositories > multilib**

После завершения установки загрузчик попросит предоставить root-доступ для нового сеанса, следует выбрать **no**.

##### Настройка графической оболочки Hyprland

Основной файл конфигурации расположен по пути `~/.config/hypr/hyprland.conf`.

Чтобы открыть терминал, необходимо нажать сочетание клавиш *Win + Q*.

Открыть файл конфигурации можно при помощи vim:
- режим редактирования: **A**
- выход из режима: **Esc**
- сохранить изменения: **:w**
- выход из vim: **:q**

Чтобы убрать желтую табличку сверху экрана, необходимо закомментировать следующую строчку:
```
autogenerated = 1
```

###### Настройка монитора(-ов) (MONITORS)

Показать список всех доступных мониторов:
```bash
hyprctl monitors
```

Далее необходимо в файле конфигурации прописать настройку в формате, например: 
```bash
monitor=eDP-1,2560x1440@240,0x0,1
# monitor=интерфейс,разрешение@герцовка,позиция,масштаб
```

###### Настройка программ (MY PROGRAMS)

В этом разделе можно добавить глобальные переменные и их значения для быстрого запуска и использования, например, чтобы быстро запускать браузер, можно добавить следующую строку:
```
$browser = firefox
```

###### Автозапуск (AUTOSTART)

Здесь можно добавить программы, которые будут запускаться при старте системы, например:
```
exec-once = waybar & hyprpaper
```

###### Сочетания клавиш (KEYBINDINGS)

```bash
bind = $mainMod, RETURN, exec, $terminal # вместо Q
bind = $mainMod, Q, killactive, # вместо C
bind = $mainMod, B, $browser

# Бинды для регулировки звука
bindel = , XF86AudioRaiseVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%+
bindel = , XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bindl = , XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
```

###### Раскладка клавиатуры (INPUT)

```bash
input {
	kb_layout = us,ru
	kb_options = grp:ctrl_shift_toggle
}
```

##### Подключение к сети (Wi-Fi)

Отобразить список сетей:
```bash
nmcli device wifi list
```

Подключение к сети:
```bash
nmcli device wifi connect <network-name> password <your-pass>
```

##### Установка и обновление пакетов 

Чтобы обновить пакеты, необходимо выполнить команду:
```bash
sudo pacman -Syu
```

Скачать пакетный менеджер, который позволяет устанавливать сторонние пакеты:
```bash
git clone https://aur.archlinux.org/yay.git
```
Далее необходимо перейти в папку `yay` и выполнить установку:
```bash
makepkg -si
```

##### Установка шрифтов

```bash
sudo pacman -S ttf-font-awesome otf-font-awesome ttf-jetbrains-mono
```

##### Установка дополнительной конфигурации Hyprland

Скачать предустановленную конфигурацию для Hyprland:
```bash
git clone https://github.com/Aptivace/hyprland-config
```

Перейти в папку `hyprland-config/kitty`.
Скопировать файл `kitty.conf`:
```bash
cp kitty.conf ~/.config/kitty/
```

Перейти в папку `hyprland-config`.
Скопировать папку `waybar`:
```bash
cp -r waybar ~/.config/
```
Скопировать папку `wofi`:
```bash
cp -r wofi ~/.config/
```
Проверить вызов меню `wofi` можно сочетанием клавиш *Win + R*.

Скопировать папку `fastfetch`:
```bash
cp -r fastfetch ~/.config/
```

Перейти в папку `hyprland-config/hypr`.
Скопировать файл `hyprlock.conf`:
```bash
cp hyprlock.conf ~/.config/hypr/
```
После чего можно добавить бинд на блокировку экрана в *KEYBINDINGS* раздел файла конфигурации `~/.config/hypr/hyprland.conf`:
```bash
bind = $mainMod, L, exec, hyprlock
```

Скопировать файл `hyprpaper.conf`:
```bash
cp hyprpaper.conf ~/.config/hypr/
```
Открыть файл `~/.config/hypr/hyprpaper.conf` и отредактировать:
```bash
# абсолютный путь к изображению
preload = 

# интерфей подключения монитора,абсолютный путь к изображению
wallpaper = 
```
Применить обои можно следующей командой:
```bash
hyprpaper
```

###### Замена оболочки

Можно заменить стандартную оболочку `bash` на любую другую, например, `fish`.
Устанавливаем необходимые для `fish` зависимости:
```bash
sudo pacman -S fish pkgfile ttf-dejavu powerline-fonts inetutils
```

Изменяем стандартную оболочку выполнив команду:
```bash
chsh
```
Нужно указать `/bin/fish` и перезагрузить систему.

###### Установка и конфигурация тем 

Для возможности кастомизации тем, иконок необходимо установить следующие пакеты:
```bash
sudo pacman -S nwg-look papirus-icon-theme
```

Установка самой темы:
```bash
git clone https://github.com/vinceliuce/Graphite-gtk-theme
```
После необходимо зайти в папку `Graphite-gtk-theme` и выполнить скрипт `install.sh`.

Чтобы применить тему, необходимо открыть `wofi` и набрать `nwg-look`, открыть программу и применить установленную тему и иконки.

###### Замена файлового менеджера

```bash
sudo pacman -S thunar
```

После, необходимо в файле конфигурации Hyprland изменить файловый менеджер в разделе `MY PROGRAMS`:
```
$fileManager = thunar
```

###### Установка дополнительных утилит

Установка меню выхода из системы
```bash
sudo pacman -S meson
```
Клонировать репозиторий:
```bash
git clone https://github.com/ArtsyMacaw/wlogout.git
```
Перейти в папку `wlogout` и выполнить следующие команды для сборки:
```bash
meson build
ninja -C build
sudo ninja -C build install
```

Установка пакета для создания скриншотов:
```bash
yay -S hyprshot
```
После установки необходимо добавить бинд для создания скринов:
```bash
bind =, PRINT, exec, hyprshot -m region
```

###### Настройка NVIDIA

Чтобы включить режим ядра DRM, необходимо добавить модули драйвера NVIDIA в initramfs. Для этого необходимо открыть файл `/etc/mkinitcpio.conf` и в массиве `MODULES` добавить следующее:
```bash
MODULES=(... nvidia nvidia_modeset nvidia_uvm nvidia_drm ...)
```

Затем необходимо создать/отредактировать файл `/etc/modprobe.d/nvidia.conf` и добавить в него следующую строку:
```bash
options nvidia_drm modeset=1 fbdev=1
```

 После этого нужно пересобрать initramfs c помощью следующей команды: 
```bash
sudo mkinitcpio -P 
```
Перезагрузите компьютер.

Добавить следующие переменные среды в файл конфигурации Hyprland `~/.config/hypr/hyprland.conf`:
```bash
env = LIBVA_DRIVER_NAME,nvidia
env = XDG_SESSION_TYPE,wayland
env = GBM_BACKEND,nvidia-drm
env = __GLX_VENDOR_LIBRARY_NAME,nvidia

cursor {
    no_hardware_cursors = true
}
```

Чтобы работало аппаратное ускорение видео, необходимо установить следующий пакет:
```bash
sudo pacman -S libva-nvidia-driver
```
 Также необходимо добавить переменную среды в файл конфигурации Hyprland `~/.config/hypr/hyprland.conf`:
```bash
env = NVD_BACKEND,direct
```

Чтобы избавиться от мерцания в большинстве приложений Electron, необходимо добавить следующую переменную среды в файл конфигурации Hyprland `~/.config/hypr/hyprland.conf`:
```bash
env = ELECTRON_OZONE_PLATFORM_HINT,auto
```
Некоторым же другим приложениям на Electron/CEF потребуется явно указать следующие флаги при запуске:
```bash
--enable-features=UseOzonePlatform --ozone-platform=wayland
```